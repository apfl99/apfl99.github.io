---
title: "Docker"
categories:
 - BEB
tags: [Docker, Cotainer, Image, Registry] 
toc: true
author_profile: true #profile sidebar 감추기
# sidebar:
#     nav: "docs" # 목차 사이드바
search: true #검색 피하기

---

# Docker

-------------

docker란 리눅스 컨테이너 기술을 기반으로, 애플리케이션의 환경을 빠르게 쉽게 구축할 수 있는 플랫폼이다.



## 용어



### 컨테이너

-------

애플리케이션이 의존성, 네트워크 환경, 파일 시스템에 구애받지 않고, 도커라는 기술 위에 실행될 수 있도록 만든 애플리케이션 상자



### 이미지

----------

실행되는 모든 컨테이너는 이미지로부터 생성되며, 이미지는 애플리케이션 및 애플리케이션 구성을 함께 담아 놓은 템플릿이다. 이미지를 이용하여 여러 개의 컨테이너를 생성할 수 있으며, 이는 수평확장에 용이하다. 또한 이미지는 기존의 이미지로부터 변경 사항을 추가/커밋하여 다른 이미지를 만들 수 있어 업데이트에 용이하다.



### 레지스트리

이미지는 레지스트리라는 공간에 저장되며, 대표적인 이미지 레지스트리로는 Docker Hub, Amazon ECR이 있다. 도커 CLI에서 이미지를 이용해 컨테이너를 생성할 때, 호스트 컴퓨터에 이미지가 존재하지 않는다면, 기본 레지스트리로부터 다운로드한다.



## Docker 컨테이너 방식의 장점



### 의존성 충돌 문제 해결(리소스 격리성)

------------

어플리케이션은 해당 어플리케이션을 실행하기 위해 어떤 환경이 구축되어야 있어야 하는데, 동일한 컴퓨터에 서로 다른 프로그램의 각각의 요구하고 있는 버전이 다르다면, 둘 중 한 어플리케이션은 제대로 된 실행을 보장할 수 없다.(의존성 충돌) 그러나 Docker 방식의 컨테이너의 경우, 어떠한 의존성도 공유하지 않고, 각자 고유의 의존성을 포함하고 있기 때문에 의존성 충돌 문제 해결이 가능하다.



#### 컨테이너 격리

1. 프로세스
   - 특정 컨테이너에서 작동하는 프로세스는 기본적으로 그 컨테이너 안에서만 엑세스할 수 있다.
   - 컨테이너 안에서 실행되는 프로세스는 다른 컨테이너의 프로세스에게 영향을 줄 수 없다.
2. 네트워크
   - 기본으로 컨테이너 하나에 하나의 IP 주소가 할당되어 있다.
3. 파일 시스템
   - 컨테이너 안에서 사용되는 파일 시스템은 구획화 되어 있어, 컨테이너에서의 명령이나 파일 등의 엑세스를 제한할 수 있다.



### 개발과 배포 환경 일치(환경 표준화)

--------

docker는 어플리케이션의 런타임 환경 및 시스템 환경 변수를 이미지로 추출하여 저장하고, 원한다면 해당 이미지를 컨테이너로 생성하여 해당 컨테이너에서 어플리케이션을 실행시킬 수 있기 때문에 도커를 통해 OS에 상관없이 즉시 애플리케이션 실행 환경을 만들 수 있으며, 개발을 컨테이너 위에서 진행할 경우, 모든 개발팀이 동일한 환경 하에 개발을 진행할 수 있다.

이는 배포시에도 Amazon Web Service의 EC2에 도커를 설치하거나, 도커 컨테이너를 EC2 서버에 실행할 수 있게 하는 서비스인 ECS를 사용한다면 보다 쉽게 애플리케이션을 배포할 수 있다.



### 수평 확장 용이 & 서버 업데이트 용이

-----------

만약 해당 서비스의 트래픽이 많아져 서버 증설이 요구될 때, 도커 컨테이너가 존재하지 않는다면, 기존 서비스와 동일한 서버를 구축하기 위해 기존 서버의 모든 실행 환경 구성을 셋팅해야 하지만, 도커 컨테이너를 활용하여 애플리케이션을 실행했다면, 해당 이미지를 바탕으로 새로운 서버에 해당 어플리케이션을 실행하고, 로드 벨런서에 서버를 추가해주기만 하면 된다. 이러한 기술을 활용하여 새로운 버전의 어플리케이션을 여러 서버 중 몇 대만 운영하여 테스트하는 방법도 가능하다.



## Docker 사용하기

[Docker 설치](https://docs.docker.com/desktop/install/mac-install/)

![img1](../../images/2022-08-19-docker/img1.png)

{: .align-center}



### 레지스트리에서 이미지 가져오기

-------

이미지는 Registry_Account/Repository_Name:Tag 정보로 구성되어져 있으며 각 역할은 다음과 같다.

- 레지스트리(Registry)
  - DockerHub, Amazon ECR 등과 같은 곳으로 도커 이미지를 관리하는 공간이다.
  - 따로 설정을 하지 않는다면, 도커 허브를 기본 레지스트리로 설정한다.
  - 레지스티리는 Docker Hub, Private Docker Hub, 회사 내부용 레지스트리 등으로 나뉠 수 있다.
- 레포지토리(Repository)
  - 레지스트리 내에 도커 이미지가 저장되는 공간이다.
  - 이미지 이름이 사용되기도 한다.
  - Github Repository와 유사하다.
- 태그(Tag)
  - 해당 이미지를 설명하는 버전 정보를 주로 입력한다.
  - 따로 설정하지 않는다면, latest 태그를 붙인 이미지를 가져온다.



이러한 정보로 구성된 이미지는 DockerHub로 접속하여 이미지를 확인한 후, Docker Pull Command를 통해 자신의 도커로 가져올 수 있으며, Overview를 통해 이미지에 대한 설명, Tag를 통해 버전 정보를 확인할 수 있다.

![img3](../../images/2022-08-19-docker/img3.png)

{: .align-center}



자신의 도커에 있는 이미지는 

```shell
docker image ls
```

명령어로 확인하거나 DockerApp - images을 통해 확인할 수 있다.

![img4](../../images/2022-08-19-docker/img4-1089367.png) {: .align-center}



### 가져온 이미지 컨테이너로 옮겨 실행하기

--------

이미지를 레지스트리에서 가져왔다면, 이미지를 구동시킬 컨테이너에 넣은 후, 실행시킨다. 이는 간단하게 명령어로는 

```shell
docker container run --name [컨테이너 이름] [이미지 이름]
```

과 같이 실행하면 되고, DockerApp으로는 해당하는 이미지의 Run을 눌러준 후, 설정하면 된다.

![img5](../../images/2022-08-19-docker/img5.png) {: .align-center}



이후 컨테이너는 

```shell
docker container ps -a
```

명령어를 통해 확인하거나 DockerApp - Containers에서 확인 가능하며, 삭제는

```shell
docker container rm [컨테이너 이름]
```

이나 DockerApp의 Container Remove를 통해 삭제할 수 있다.

![img6](../../images/2022-08-19-docker/img6.png) {:.align-center}



### Docker 컨테이너에 파일 복사하기

------





<div class="notice">
  <p>본 포스팅은 코드스테이츠 BEB 과정을 수강하며 작성한 글입니다.</p>
  <h5>Reference</h5>  	      		<a>https://docs.docker.com/engine/reference/commandline/docker/</a>
  <br>
</div>



